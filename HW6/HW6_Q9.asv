y_exact = @(t) 1/5*t.*exp(3*t) - 1/25*exp(3*t) + 1/25*exp(-2*t);
f = @(t,y) t*exp(3*t) - 2*y;
a = 0;
h = 0.2;
b = 1;
N = b-a/h;
t_series = a:h:b;
w0 = 0;
w1 = y_exact(t_series(2));
w2 = y_exact(t_series(3));
w3 = y_exact(t_series(4));

hold on
tt = a:0.01:b;
plot(tt, y_exact(tt))

%AB2
w = zeros(1,N+1)
w(1) = w0;
w(2) = w1;

for i = 2:N
    w(i+1) = w(i) + h/2*(3*f(t(i), w(i)) - f(t(i-1), w(i-1)))
end
plot(t,w)

%AB3
w = zeros(1,N+1)
w(1) = w0;
w(2) = w0;

for i = 3:N
    w(i+1)
end